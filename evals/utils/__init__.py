# flake8: noqa
import importlib
import inspect
import os
import sys
import time
import traceback
from traceback import FrameSummary, StackSummary
from types import FrameType, ModuleType
from typing import Callable, List, Optional, Union

from evals.utils.common import (
    aggregate_fn_macro_avg,
    aggregate_results,
    apply_functions,
    batchify,
    check_pattern,
    evaluate,
    ExampleSelector,
    filter_by_pattern,
    filter_string_numericals,
    find_majority,
    first_answer,
    flatten_dict,
    format_dict,
    get_checkpoint_step,
    get_git_info,
    get_gpu_info,
    get_group_by_metrics,
    get_job_info,
    get_local_path,
    get_random_state,
    get_token_offsets,
    get_torch_dtype,
    get_version,
    initialize_logger,
    jinja_format,
    load_jsonl,
    normalize_answer,
    open_file,
    remove_articles,
    remove_punc,
    setup_env,
    string_format,
    text_index,
    truncate,
    truncate_chat,
    unroll_chat,
    unroll_configs,
    white_space_fix,
    write_to_json,
    write_to_jsonl,
    write_to_tensorboard,
)
from evals.utils.distributed import (
    all_gather_object,
    all_reduce,
    broadcast_object_list,
    gather_object,
    get_dp_group,
    get_dp_rank,
    get_dp_size,
    get_global_rank,
    get_local_rank,
    get_master_addr,
    get_master_port,
    get_mp_group,
    get_mp_rank,
    get_mp_size,
    get_rank,
    get_world_size,
    init_model_parallel,
    init_torch_distributed,
    is_slurm_job,
    is_torch_run,
    mean_reduce_dict,
    mp_rank_zero_debug,
    mp_rank_zero_info,
    mp_rank_zero_warn,
    rank_zero_debug,
    rank_zero_error,
    rank_zero_info,
    rank_zero_print,
    rank_zero_warn,
)
